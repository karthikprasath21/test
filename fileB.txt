edited from sub-two-branch 
new code        
